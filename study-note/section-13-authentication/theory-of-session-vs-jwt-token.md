# JWT Token vs Session

## Session?
- 유저의 정보를 데이터베이스에 저장하고 상태를 유지하는 도구.

### Session의 특징
- Session은 특수한 ID의 값으로 구성되어 있다.
- Session은 서버에서 생성되며 클라이언트에서 쿠키를 통해 저장된다.
- 클라이언트에서 요청을 보낼 때 Session ID를 같이 보내면 현재 요청을 보내는 사용자가 누구인지 서버에서 알 수 있다.(요청마다 매번 아이디와 비밀번호를 물어볼 필요 없음)
- Session ID는 데이터베이스에 저장되기 때문에 요청이 있을때마다 매번 데이터베이스를 확인해야 한다.
- 서버에서 데이터가 저장되기 때문에 클라이언트에 사용자 정보가 노출될 위험이 없다.
- 데이터베이스에 Session을 저장해야 하기 때문에 Horizontal Scaling이 어렵다.

### Session 생성 방식

    1. Client에서 ID / Password 전송
    2. 서버에서 ID / Password 검증
    3. DB에 세션 생성 및 저장
    4. 쿠키로 세션 클라이언트에게 전송

### Session 사용 방식
    1. 클라이언트에서 쿠키 전송
    2. 서버에서 검증
    3. DB에서 해당 세션 검색
    4. DB에서 유저 정보 응답
    5. 클라이언트에서 요청한 데이터 DB에 요청
    6. DB에서 데이터 응답
    7. 서버에서 클라이언트로 응답받은 데이터 전송 

## JWT Token?
- 유저의 정보를 Base 64로 인코딩된 String 값에 저장하는 도구

### JWT Token의 특징
- JWT Token은 Header, Payload, Signature로 구성되어 있으며 Base 64로 인코딩 되어 있다.
- JWT Token은 서버에서 생성되며 클라이언트에서 저장된다.
- 클라이언트에서 요청을 보낼 때 JWT Token ID를 같이 보내면 현재 요청을 보내는 사용자가 누구인지 서버에서 알 수 있다. (요청마다 매번 아이디와 비밀번호를 물어볼 필요 없음.)
- JWT Token은 데이터베이스에 저장되지 않고 Signature 값을 이용해서 검증할 수 있다. 그래서 검증할때마다 데이터베이스를 매번 들여다볼 필요가 없다.
- 정보가 모두 토큰에 담겨있고 클라이언트에서 토큰을 저장하기 때문에 정보 유출의 위험이 있다.
- 데이터베이스가 필요없기 때문에 Horizontal Scaling이 쉽다.

### JWT Token 생성 방식
    1. 클라이언트에서 ID / Password 서버로 전송
    2. 서버에서 검증
    3. JWT Token 생성
    4. JWT Token 클라이언트에게 전송

### JWT Token 사용 방식
    1. 클라이언트에서 토큰 전송
    2. 서버에서 토큰 검증
    3. DB에 클라이언트가 요청한 데이터 요청
    4. DB에서 데이터 응답
    5. 서버에서 클라이언트로 데이터 전송

## Session vs JWT Token 비교
| 비교 요소      | Session      |     JWT Token |
| ------------ | ----------- | -------------- |
| 유저의 정보를 어디에서 저장하고 있는가?    | 서버 | 클라이언트 |
| 클라이언트에서 서버로 보내는 정보는?    | 쿠키 | 토큰 |
| 유저 정보를 가져올때 데이터베이스를 확인해야 하는가?    | 확인필요 | 토큰의 Payload에 들어있는 정보만 필요할 경우 확인 불필요 |
| 클라이언트에서 인증 정보를 읽을 수 있는가?    | 불가능 | hapi 가능 |
| Horizontal Scaling(수평적 확장)    | 어려움 | 쉬움 |





